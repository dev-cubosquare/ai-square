---
import TestimonialCard from './TestimonialCard.astro';
import { testimonials } from '@/data/testimonials';

interface Props {
  title?: string;
  description?: string;
  featured?: boolean;
  limit?: number;
  productId?: string; // Filter by product
  className?: string;
}

const {
  title = "What Our Customers Say",
  description = "Join thousands of satisfied customers who have transformed their businesses with AI Square.",
  featured = true,
  limit = 6,
  productId,
  className = ""
} = Astro.props;

let filteredTestimonials = testimonials;

// Filter by featured
if (featured) {
  filteredTestimonials = filteredTestimonials.filter(t => t.featured);
}

// Filter by product
if (productId) {
  filteredTestimonials = filteredTestimonials.filter(t => t.productId === productId);
}

// Apply limit
if (limit) {
  filteredTestimonials = filteredTestimonials.slice(0, limit);
}
---

<section class={`py-16 sm:py-20 lg:py-24 ${className}`}>
  <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Section Header -->
    <div class="text-center max-w-3xl mx-auto mb-12">
      <h2 class="text-3xl sm:text-4xl font-bold tracking-tight mb-4">
        {title.split(' ').slice(0, -2).join(' ')}
        <span class="bg-gradient-to-r from-accent via-primary to-accent bg-clip-text text-transparent">
          {title.split(' ').slice(-2).join(' ')}
        </span>
      </h2>
      <p class="text-lg text-muted-foreground">
        {description}
      </p>
    </div>

    <!-- Testimonials Grid -->
    {filteredTestimonials.length > 0 ? (
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {filteredTestimonials.map((testimonial) => (
          <TestimonialCard testimonial={testimonial} />
        ))}
      </div>
    ) : (
      <div class="text-center py-12">
        <p class="text-muted-foreground">No testimonials available at the moment.</p>
      </div>
    )}
  </div>
</section>
